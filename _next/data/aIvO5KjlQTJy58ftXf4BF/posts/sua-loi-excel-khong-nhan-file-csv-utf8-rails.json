{"pageProps":{"slug":"sua-loi-excel-khong-nhan-file-csv-utf8-rails","title":"Rails | Sửa lỗi Excel không nhận file csv với BOM","date":"Mon Mar 07 2022 19:25:40 GMT+0700 (Indochina Time)","description":"Khi bạn làm chức năng tạo file csv mà mở trên excel bị lỗi font chữ, bạn có thể thêm BOM","tags":["Rails"],"content":"<h1>Rails | Sửa lỗi Excel không nhận file csv với BOM</h1>\n<p>Bom viết tắt của Byte Order Mark, được sử dụng để đưa thông tin rằng file của bạn đang được mã hóa Unicode. Bình thường Excel có thể xử lý UTF-8, nhưng thỉnh thoảng nó sẽ không nhận dạng được file của bạn là UTF-8. Và bạn có thể sửa bằng cách <strong>thêm BOM vào đầu tập tin csv của bạn</strong>.</p>\n<p>Ví dụ với khi tạo file csv:</p>\n<pre><code class=\"hljs language-rb\"><span class=\"hljs-comment\"># generate có thể tham số đầu tiên làm mặc định khi tạo file</span>\ncsv_string = CSV.generate(<span class=\"hljs-string\">\"\\uFEFF\"</span>) <span class=\"hljs-keyword\">do</span> <span class=\"hljs-params\">|csv|</span>\n  csv &#x3C;&#x3C; [<span class=\"hljs-string\">\"ẽxa\"</span>, <span class=\"hljs-string\">\"beta\"</span>, <span class=\"hljs-string\">\"æm\"</span>, <span class=\"hljs-string\">\"Text これは\"</span>]\n<span class=\"hljs-keyword\">end</span>\n\nCSV.open(filename, <span class=\"hljs-string\">\"w\"</span>) <span class=\"hljs-keyword\">do</span> <span class=\"hljs-params\">|csv|</span>\n  csv.to_io.write <span class=\"hljs-string\">\"\\uFEFF\"</span>\n  csv &#x3C;&#x3C; [<span class=\"hljs-string\">\"ẽxa\"</span>, <span class=\"hljs-string\">\"beta\"</span>, <span class=\"hljs-string\">\"æm\"</span>, <span class=\"hljs-string\">\"Text これは\"</span>]\n<span class=\"hljs-keyword\">end</span>\n</code></pre>"},"__N_SSG":true}
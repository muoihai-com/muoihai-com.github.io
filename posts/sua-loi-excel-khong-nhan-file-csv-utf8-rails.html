<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>Rails | Sửa lỗi Excel không nhận file csv với BOM | Hungkieu&#x27;s blog</title><meta name="description" content="Khi bạn làm chức năng tạo file csv mà mở trên excel bị lỗi font chữ, bạn có thể thêm BOM"/><meta name="next-head-count" content="4"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="true"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><link rel="preload" href="/_next/static/css/77b952c78de83359.css" as="style"/><link rel="stylesheet" href="/_next/static/css/77b952c78de83359.css" data-n-g=""/><link rel="preload" href="/_next/static/css/ee64063c17e45e95.css" as="style"/><link rel="stylesheet" href="/_next/static/css/ee64063c17e45e95.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-69bfa6990bb9e155.js" defer=""></script><script src="/_next/static/chunks/framework-5f4595e5518b5600.js" defer=""></script><script src="/_next/static/chunks/main-a054bbf31fb90f6a.js" defer=""></script><script src="/_next/static/chunks/pages/_app-2fa1a84ec5e1b202.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bslug%5D-6a804a76f9f7ec33.js" defer=""></script><script src="/_next/static/zkVApzwE2iXr9Hxj3ECf6/_buildManifest.js" defer=""></script><script src="/_next/static/zkVApzwE2iXr9Hxj3ECf6/_ssgManifest.js" defer=""></script><script src="/_next/static/zkVApzwE2iXr9Hxj3ECf6/_middlewareManifest.js" defer=""></script><style data-href="https://fonts.googleapis.com/css2?family=Bitter:wght@500&display=swap">@font-face{font-family:'Bitter';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/bitter/v25/raxhHiqOu8IVPmnRc6SY1KXhnF_Y8cTfCLw.woff) format('woff')}@font-face{font-family:'Bitter';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/bitter/v25/raxhHiqOu8IVPmnRc6SY1KXhnF_Y8cTfOLXOW3pzveS5B3Nd.woff) format('woff');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Bitter';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/bitter/v25/raxhHiqOu8IVPmnRc6SY1KXhnF_Y8cTfOLzOW3pzveS5B3Nd.woff) format('woff');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Bitter';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/bitter/v25/raxhHiqOu8IVPmnRc6SY1KXhnF_Y8cTfOLfOW3pzveS5B3Nd.woff) format('woff');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Bitter';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/bitter/v25/raxhHiqOu8IVPmnRc6SY1KXhnF_Y8cTfOLbOW3pzveS5B3Nd.woff) format('woff');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Bitter';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/bitter/v25/raxhHiqOu8IVPmnRc6SY1KXhnF_Y8cTfOLjOW3pzveS5Bw.woff) format('woff');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body><div id="__next" data-reactroot=""><div class="styles_layout__uw121"><main class="styles_main__ZTqbU"><div class="styles_article__gKJAH"><article><a href="/">← Quay về trang chủ</a><div class="styles_htmlBody__Y9rnw"><h1>Rails | Sửa lỗi Excel không nhận file csv với BOM</h1>
<p>Bom viết tắt của Byte Order Mark, được sử dụng để đưa thông tin rằng file của bạn đang được mã hóa Unicode. Bình thường Excel có thể xử lý UTF-8, nhưng thỉnh thoảng nó sẽ không nhận dạng được file của bạn là UTF-8. Và bạn có thể sửa bằng cách <strong>thêm BOM vào đầu tập tin csv của bạn</strong>.</p>
<p>Ví dụ với khi tạo file csv:</p>
<pre><code class="hljs language-rb"><span class="hljs-comment"># generate có thể tham số đầu tiên làm mặc định khi tạo file</span>
csv_string = CSV.generate(<span class="hljs-string">"\uFEFF"</span>) <span class="hljs-keyword">do</span> <span class="hljs-params">|csv|</span>
  csv &#x3C;&#x3C; [<span class="hljs-string">"ẽxa"</span>, <span class="hljs-string">"beta"</span>, <span class="hljs-string">"æm"</span>, <span class="hljs-string">"Text これは"</span>]
<span class="hljs-keyword">end</span>

CSV.open(filename, <span class="hljs-string">"w"</span>) <span class="hljs-keyword">do</span> <span class="hljs-params">|csv|</span>
  csv.to_io.write <span class="hljs-string">"\uFEFF"</span>
  csv &#x3C;&#x3C; [<span class="hljs-string">"ẽxa"</span>, <span class="hljs-string">"beta"</span>, <span class="hljs-string">"æm"</span>, <span class="hljs-string">"Text これは"</span>]
<span class="hljs-keyword">end</span>
</code></pre></div></article><footer class="styles_footer__UG76L">©<a class="styles_link__KytYE" href="https://github.com/hungkieu">hungkieu</a>2022</footer></div></main></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"slug":"sua-loi-excel-khong-nhan-file-csv-utf8-rails","title":"Rails | Sửa lỗi Excel không nhận file csv với BOM","date":"Mon Mar 07 2022 19:25:40 GMT+0700 (Indochina Time)","description":"Khi bạn làm chức năng tạo file csv mà mở trên excel bị lỗi font chữ, bạn có thể thêm BOM","tags":["Rails"],"content":"\u003ch1\u003eRails | Sửa lỗi Excel không nhận file csv với BOM\u003c/h1\u003e\n\u003cp\u003eBom viết tắt của Byte Order Mark, được sử dụng để đưa thông tin rằng file của bạn đang được mã hóa Unicode. Bình thường Excel có thể xử lý UTF-8, nhưng thỉnh thoảng nó sẽ không nhận dạng được file của bạn là UTF-8. Và bạn có thể sửa bằng cách \u003cstrong\u003ethêm BOM vào đầu tập tin csv của bạn\u003c/strong\u003e.\u003c/p\u003e\n\u003cp\u003eVí dụ với khi tạo file csv:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-rb\"\u003e\u003cspan class=\"hljs-comment\"\u003e# generate có thể tham số đầu tiên làm mặc định khi tạo file\u003c/span\u003e\ncsv_string = CSV.generate(\u003cspan class=\"hljs-string\"\u003e\"\\uFEFF\"\u003c/span\u003e) \u003cspan class=\"hljs-keyword\"\u003edo\u003c/span\u003e \u003cspan class=\"hljs-params\"\u003e|csv|\u003c/span\u003e\n  csv \u0026#x3C;\u0026#x3C; [\u003cspan class=\"hljs-string\"\u003e\"ẽxa\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"beta\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"æm\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"Text これは\"\u003c/span\u003e]\n\u003cspan class=\"hljs-keyword\"\u003eend\u003c/span\u003e\n\nCSV.open(filename, \u003cspan class=\"hljs-string\"\u003e\"w\"\u003c/span\u003e) \u003cspan class=\"hljs-keyword\"\u003edo\u003c/span\u003e \u003cspan class=\"hljs-params\"\u003e|csv|\u003c/span\u003e\n  csv.to_io.write \u003cspan class=\"hljs-string\"\u003e\"\\uFEFF\"\u003c/span\u003e\n  csv \u0026#x3C;\u0026#x3C; [\u003cspan class=\"hljs-string\"\u003e\"ẽxa\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"beta\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"æm\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"Text これは\"\u003c/span\u003e]\n\u003cspan class=\"hljs-keyword\"\u003eend\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e"},"__N_SSG":true},"page":"/posts/[slug]","query":{"slug":"sua-loi-excel-khong-nhan-file-csv-utf8-rails"},"buildId":"zkVApzwE2iXr9Hxj3ECf6","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>